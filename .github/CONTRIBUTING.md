# Contributing to Vitrine

Hi there! If you're reading this, you probably want to contribute to Vitrine, I first want to thank you for that!
My name is Paul, I'm the creator and the main developper of Vitrine.
This guide is here to help you understaning the philosophy of the project, getting you started and giving you guidelines for further contributions.
Note that this guide is likely to change in the future, so feel free to check again this file at some point.

As you probably already know it, Vitrine is using web technologies to run, the fundation of the project is the Electron framework, using both Chromium and Node.js APIs.
We're also using TypeScript instead of pure JavaScript in order to have a more stable and safe code.

## Getting Vitrine compiling and running

The first step to get Vitrine running is to install its dependencies. We're using Yarn as a packages manager, so you just need to clone the repository and run `yarn install`.

Vitrine is using custom Node.js native addons, written in C++, which need to be compiled. For the moment, Vitrine is only running on Windows, which means that the C++ addons can only be compiled using Visual C++ Build Tools. 
You need to download and install [Windows-Build-Tools](https://github.com/felixrieseberg/windows-build-tools).

## Writing code

Few things on how we code here:
* We are using [TSLint](https://palantir.github.io/tslint) to format the code, so when you are writting make sure to run `yarn run lint-app` to see if your code is compliant to the styleguide.
* If you don't manually format your code, TSLint will automatically fix it at `precommit`.
* We use [Mocha](https://mochajs.org) along with [Chai](http://www.chaijs.com) to write tests. For the moment, tests are not fully provided, so feel free to write some for existing pieces of code.
* We are using [WebStorm](https://www.jetbrains.com/webstorm) as IDE. You're free to use any editor you want, we're are using it because it has extensions for Mocha and TSLint.

## Project file structure

Vitrine wasn't build using any boilerplate, so the the file structure is pretty free and tweakable:
- `/.circleci`: contains a `config.yml` file used for CircleCI configuration
- `/config`: used to store config used by Vitrine, copied within build
  - `/lang`: here are the files for i18n, just regular JSON files with a key value system
  - `/modules_config.json`: static information that aren't supposed to change, like emulators list or Origin registry keys
  - `/potential_games.json`: list of cached information from IGDB API to optimize queries, shouldn't be edited
  - `/vitrine_config.json`: configuration edited directly from the software by the used, persistently stored here
- `/dist`: the built software is stored here
- `/games`: here lies what everything is about! Every game is stored in a folder using a UUID and containing a `config.json`, and potentially a `cover.XXXXXXXX.jpg` and a `background.XXXXXXXX.jpg` (`XXXXXXXX` is a unique tag used for caching)
- `/modules`: the build native Node.js modules (`.node` files) are stored here
- `/node_modules`: you already know what's is here
- `/public`: transpiled code lies here. `client.html` and `loader.html` are generated by `webpack-html-plugin`
  - `/img`: images needed for the packaging process stored here
- `/scripts`: nothing really interesting, just some scripts used for build process
- `/sources`: that's pretty much what you're looking for, so let's begin, shall we?
  - `/client`: sources executed in the `rendered` process of Electron are located here
    - `/app`: the React app of Vitrine client is stored here. It has a simple React/Redux app structure (`actions`, `components`, `containers`, `reducers` folders)
    - `/resources`: every asset used by the client that is not source code is located here. They will by directly loaded into `client.js` and `loader.js` when transpiling. The `less` folder (hosting the stylesheets used by the client) is structured using `Semantic UI Less`
  - `/defs`: here are located special TypeScript definitions (like the ones used to import custom files in TypeScript) as `.d.ts` files
  - `/models`: pieces of code used both on the client and the server-side
  - `/modules`: C++ source code for native Node.js modules. Each module folder contains a `build` and a `srcs` folder, a `binding.gyp` (containing informations about module build) and a TypeScript definitions file (`.d.ts`)
  - `/server`: sources executed in the `main` process of Electron are located here
    - `/api`: the source code here depends on a certain support to work (platform or file format) and should be only used as an interface by the other files (specific implementation hidden)
    - `/crawlers`: the list of the games crawlers is located here. The `PlayableGamesCrawler` class search for already playable games and `PotentialGamesCrawler` class is extended to build games crawlers depending on the platform
- `/tests`: pretty self-explanatory
